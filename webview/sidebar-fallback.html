<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src {{CSP_SOURCE}} 'unsafe-inline'; script-src 'nonce-{{NONCE}}';">
  <title>Excel编辑器</title>
  <link rel="stylesheet" href="{{STYLE_URI}}">
</head>
<body>
  <div class="container">
    <div class="header-section">
      <div class="header-top">
        <div class="header-left">
          <h3>Excel编辑</h3>
          <div class="status-indicator active" id="statusIndicator">
            <span>已激活</span>
            <span class="status-hotkey">Ctrl+0</span>
          </div>
        </div>
      </div>
      
      <div class="file-info" id="fileInfo">
        <div>未打开Excel文件</div>
      </div>
      
      <div class="file-stats" id="fileStats">
        <span>总行: 0</span>
        <span>总列: 0</span>
        <span>当前行: 无</span>
      </div>

      <div class="header-row-selector">
        <label for="headerRowInput">表头行:</label>
        <input type="number" id="headerRowInput" class="header-row-input" min="1" value="1">
        <span class="header-row-hint">共 <span id="totalRowCount">1</span> 行</span>
      </div>
    </div>
    
    <div class="main-content" id="mainContent">
      <div class="form-container" id="formContainer" style="display: none;">
        <div class="form-scroll-container">
          <div id="formFields"></div>
        </div>
      </div>
      
      <div class="empty-state" id="emptyState">
        <div class="empty-icon">📊</div>
        <h3>Excel编辑器</h3>
        <p>打开一个Excel文件开始编辑</p>
        <div class="empty-actions">
          <button id="openExcelBtn" class="primary-btn">打开Excel文件</button>
          <p class="hint">支持 .xlsx, .xls, .xlsm, .xlsb 格式</p>
          <p class="hint">提示：在编辑器中打开文件会自动加载</p>
        </div>
      </div>
    </div>
    
    <div class="footer-section">
      <button class="add-row-btn" id="addRowBtn">添加新行</button>
    </div>
  </div>
  
  <script nonce="{{NONCE}}">
    const vscode = acquireVsCodeApi();
    
    document.getElementById('openExcelBtn').addEventListener('click', () => {
      vscode.postMessage({ type: 'openExcel' });
    });
    
    document.getElementById('addRowBtn').addEventListener('click', () => {
      vscode.postMessage({ type: 'addRow', rowData: {} });
    });
  </script>
</body>
</html>